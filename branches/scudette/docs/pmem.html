<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.6" />
<title>The Pmem Memory acquisition suite.</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }


/*
 * xhtml11 specific
 *
 * */

tt {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}
@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>The Pmem Memory acquisition suite.</h1>
<span id="author">Michael Cohen</span><br />
<span id="email"><tt>&lt;<a href="mailto:scudette@gmail.com">scudette@gmail.com</a>&gt;</tt></span><br />
<span id="revdate">November 2012</span>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Memory acquisition is the first step in memory analysis. Before any analysis can
be done, we need to acquire the memory in the first place. There are a number of
commercial solutions to acquire memory, but sadly open source solutions have
been abandoned or not maintained (For example win32dd has been a popular
solution many years ago but has now been commercialized and is no longer open
source).</p></div>
<div class="paragraph"><p>We believe in open source forensic tools to make testing and transparency
easier. We also believe that the availability of open source solutions spurs
further development in the field and enables choices.</p></div>
<div class="paragraph"><p>That is the reason we feel an open source, well tested and capable forensic
memory acquisition tool is essential - we call it the Pmem suite of tools. The
pmem acquisition tool aims to provide a complete imaging solution for Windows,
Linux and OSX.</p></div>
<div class="paragraph"><p>The following is a quick overview of how to use the pmem tools. For detailed
information consult the source.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_winpmem">1. WinPmem</h2>
<div class="sectionbody">
<div class="paragraph"><p>The windows memory acquisition tool is called WinPmem.</p></div>
<div class="paragraph"><p>These are the features it supports:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Supports all windows versions from WinXP SP2 to Windows 8 in both i386 and
amd64 flavours.
</p>
</li>
<li>
<p>
Output formats include:
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
Raw memory images.
</p>
</li>
<li>
<p>
Microsoft Crashdump files for use in windbg and volatility.
</p>
</li>
<li>
<p>
Output to stdout (in both the above formats) for piping through other tools
(e.g. ssh, ewfacquirestream etc).
</p>
</li>
</ol></div>
</li>
<li>
<p>
Memory acquisition using
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
MmMapIoSpace method.
</p>
</li>
<li>
<p>
\Device\PhysicalMemory and ZwMapViewOfSection method.
</p>
</li>
</ol></div>
</li>
<li>
<p>
Direct analysis of the running kernel using Volatility (Live memory analysis).
</p>
</li>
<li>
<p>
Optional Write support for manipulating kernel data structures from Volatility.
</p>
</li>
</ol></div>
<div class="sect2">
<h3 id="_download">1.1. Download</h3>
<div class="paragraph"><p>The latest version can be found
<a href="http://volatility.googlecode.com/svn/branches/scudette/tools/windows/winpmem/executable/Release/">here</a>
or on the Volatility download page. You will find the tool released in two
versions:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="http://volatility.googlecode.com/svn/branches/scudette/tools/windows/winpmem/executable/Release/winpmem-1.3.1.exe">winpmem-1.3.1.exe</a>: is the recommended binary for general use. This binary
  contains signed drivers so it can load on any windows system (even 64 bit
  ones). This binary does not include write support for memory.
</p>
</li>
<li>
<p>
winpmem-1.3.1-write.exe: is the binary with write support enabled. It is not
  signed so it will only work on 32 bit windows or 64 bit windows with special
  preparation (see below).
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="images/icons/important.png" alt="Important" />
</td>
<td class="content">The recommended version for regular use is the one without write
support. The version with write support can not be used on a regular system.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="content">
<pre><tt>c:\..&gt; winpmem_1.3.exe -h
Winpmem - A memory imager for windows.
Copyright Michael Cohen (scudette@gmail.com) 2012.

Version 1.3. Built Nov 12 2012
Usage:
  winpmem_1.3.exe [option] [output path]

Option:
  -l    Load the driver and exit.
  -u    Unload the driver and exit.
  -h    Display this help.
  -w    Turn on/off write mode.
  -1    Use MmMapIoSpace method.
  -2    Use \\Device\PhysicalMemory method (Default).
  -d    Produce a crashdump file.


NOTE: an output filename of - will write the image to STDOUT.</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_examples">1.2. Examples</h3>
<div class="paragraph"><p>Writes a raw image to physmem.raw</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>winpmem_1.3.exe physmem.raw</tt></pre>
</div></div>
<div class="paragraph"><p>Writes a crashdump file to netcat for network transport. Output is supressed
here because STDOUT is redirected.</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>winpmem_1.3.exe -d - | nc 192.168.1.1 80</tt></pre>
</div></div>
<div class="paragraph"><p>Normally the driver will be automatically unloaded after the image is
acquired. To allow volatility to attach to the raw device for live analysis, we
need to load the driver and exit:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>c:\..&gt; winpmem.exe -l
Loaded Driver.
c:\..&gt; vol.py -f \\.\pmem</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="images/icons/note.png" alt="Note" />
</td>
<td class="content">Only the tech preview volatility version is able to open the raw
device. In the tech preview version there is no need to specify a profile, since
it is autodetected.</td>
</tr></table>
</div>
<div class="paragraph"><p>To unload the driver and exit:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>c:\..&gt; winpmem.exe -u
Driver Unloaded.</tt></pre>
</div></div>
<div class="paragraph"><p>To acquire a raw image using the MmMapIoSpace method:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>c:\..&gt; winpmem_1.3.exe -1 myimage.raw</tt></pre>
</div></div>
<div class="paragraph"><p>To acquire an image in crashdump format:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>c:\..&gt;winpmem_1.3.exe -d c:\temp\test.dmp
Driver Unloaded.
Loaded Driver C:\Users\mic\AppData\Local\Temp\win6C6.tmp.
Will write a crash dump file
CR3: 0x0000187000
 2 memory ranges:
Start 0x00001000 - Length 0x0009E000
Start 0x00100000 - Length 0x6F6FB000


00% 0x00001000 .

00% 0x00100000 ..................................................
02% 0x03300000 ..................................................
05% 0x06500000 ..................................................
...
92% 0x67300000 ..................................................
95% 0x6A500000 ..................................................
98% 0x6D700000 .................................
Driver Unloaded.</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_experimental_write_support">1.3. Experimental write support</h3>
<div class="paragraph"><p>As from Version 1.1, the winpmem drivers support writing to memory as well as
reading. This capability is a great learning tool since many rootkit hiding
techniques can be emulated by writing to memory directly. For example the
following Volatility session illustrates changing the name of the binary:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>c:..&gt; vol.py -f \\.\pmem

WinXPSP2x86:pmem 03:10:40&gt; task = session.profile._EPROCESS(0x82079c18)
WinXPSP2x86:pmem 03:10:57&gt; task.ImageFileName
                    Out    [String:ImageFileName]: 'cmd.exe\x00'
WinXPSP2x86:pmem 03:11:15&gt; task.ImageFileName = "foo.exe\x00"
WinXPSP2x86:pmem 03:11:21&gt; task.ImageFileName
                    Out    [String:ImageFileName]: 'foo.exe\x00'</tt></pre>
</div></div>
<div class="paragraph"><p>Since this is a rather dangerous capability, the signed binary drivers have
write support disabled. The unsigned binaries (really self signed with a test
certificate) can not load on a regular system due to them being test self
signed. You can allow the unsigned drivers to be loaded on a test system by
issuing (see
<a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff553484(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/hardware/ff553484(v=vs.85).aspx</a>):</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>Bcdedit.exe -set TESTSIGNING ON</tt></pre>
</div></div>
<div class="paragraph"><p>and reboot. You will see a small "Test Mode" text on the desktop to remind you
that this machine is configured for test signed drivers.</p></div>
<div class="paragraph"><p>Alternatively you can test this on XP or Vista32 which have no driver signing
restrictions.</p></div>
<div class="paragraph"><p>Once the correct driver is loaded, Write support must also be enabled at load
time using the -w switch:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>winpmem_1.3-write.exe -w -l</tt></pre>
</div></div>
<div class="paragraph"><p>This will load the drivers and turn on write support. Then we can run volatility
interactively, as usual on the raw device:</p></div>
<div class="literalblock">
<div class="content">
<pre><tt>vol.exe --profile Win7SP1x64 --file \\.\pmem</tt></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_osxpmem_mac_os_x_physical_memory_acquisition_tool">2. OSXPMem - Mac OS X Physical Memory acquisition tool</h2>
<div class="sectionbody">
<div class="paragraph"><p>The OSX Memory Imager was written by Johannes Stuettgen
(<a href="mailto:johannes.stuettgen@gmail.com">johannes.stuettgen@gmail.com</a>) as an open source tool to acquire physical memory
on an Intel based Mac. It consists of 2 components:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
The usermode acquisition tool <em>osxpmem</em>, which parses the accessible sections
  of physical memory and writes them to disk in a specific format.
</p>
</li>
<li>
<p>
A generic kernel extension <em>pmem.kext</em>, that provides read only access to
  physical memory. After loading it into the kernel it provides a device file
  (<em>/dev/pmem/</em>), from which physical memory can be read.
</p>
</li>
</ol></div>
<div class="sect2">
<h3 id="_download_2">2.1. Download</h3>
<div class="paragraph"><p>The binaries can be found here <a href="http://volatility.googlecode.com/svn/branches/scudette/tools/osx/OSXPMem/">http://volatility.googlecode.com/svn/branches/scudette/tools/osx/OSXPMem/</a> or from the volatility downloads page.</p></div>
</div>
<div class="sect2">
<h3 id="_usage">2.2. Usage</h3>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
You need root access for this to work so first open a root shell (<em>sudo su</em>).
</p>
</li>
<li>
<p>
Now unpack the archive (<em>tar xvf OSXPMem.tar.gz</em>). This creates a new
  directory <em>OSXPMem</em> containing the binary <em>osxpmem</em>, as well as the
  kernel extension <em>pmem.kext</em>.
</p>
</li>
<li>
<p>
Enter the directory you just created (<em>cd OSXPMem</em>).
</p>
</li>
<li>
<p>
Run the imager by passing it a file-name for the memory image.
  (<em>./osxpmem memory.dump</em> will create a file named <em>memory.dump</em>).
</p>
</li>
</ol></div>
<div class="paragraph"><p>The imager supports multiple output formats, at the moment these are Mach-O, ELF
and zero-padded RAW. You can select which output format to use by passing the
<em>--format</em> option. For example to write a Mach-O image you would invoke
<em>./osxpmem --format mach memory.dump</em>. The default output format is ELF.</p></div>
<div class="paragraph"><p>For more information on different command line switches run <em>./osxpmem --help</em>.</p></div>
</div>
<div class="sect2">
<h3 id="_common_pitfalls">2.3. Common Pitfalls</h3>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Mac OS X only allows kernel extension to load if they are owned by the user
  <em>root</em> and the group <em>wheel</em>. The distribution package has this already set up
  for you. However, if you accidentally extract the archive as a normal user
  (eg.  omit <em>sudo su</em> before unpacking the tarball), permissions might become
  corrupted and the loading of the driver will fail. In this case you can
  correct the problem by running <em>sudo chown -R root:wheel ./pmem.kext</em> from
  within the <em>OSXPMem</em> directory.
</p>
</li>
<li>
<p>
If you try to run the imager from NFS or another networked file-system,
  permissions might also become corrupted. If the imager reports a failure to
  load the pmem driver, check the drivers permissions. If it is not owned by
  user <em>root</em> and group <em>wheel</em> and step 1 can&#8217;t correct this, try copying it
  somewhere else and correct permissions there.
</p>
</li>
</ol></div>
</div>
<div class="sect2">
<h3 id="_compatibility">2.4. Compatibility</h3>
<div class="paragraph"><p>Due to the nature of physical memory access many things are very platform
dependent. The tool is designed to work on 64 bit Intel Macs. It can probably be
compiled to work in 32 bit mode, the binary distribution however only contains
64 bit binaries.</p></div>
<div class="paragraph"><p>Several low-level api&#8217;s have changed in recent OS X versions. We have tested the
imager and driver on OS X 10.7 and 10.8, on which they work flawlessly. It
should also work on 10.6, but might encounter problems unloading the driver, as
the unloading api in IOKit is new in 10.7.</p></div>
<div class="paragraph"><p>We have also successfully tested the tool in a VMWare Fusion OS X 10.7 machine,
so it should work in virtualized environments.</p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2012-11-15 13:37:03 CET
</div>
</div>
</body>
</html>
