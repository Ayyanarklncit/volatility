#summary Expert Witness Files

= Introduction =

Memory acquired by !EnCase or converted using ewfacquire are stored in Expert Witness Format (EWF).  Volatility supports the "older" EWF format used by !EnCase v6 and below and not the newer EWF2-EX01 format used in !EnCase v7.

= Acquisition = 

Click on "Add Device" in !EnCase and then make sure that "Physical Memory" is checked.  Depending on your version of !EnCase (EE for example), the folders may differ below.

[https://lh5.googleusercontent.com/-i0HmBBIS1HQ/UFD5PSAPYTI/AAAAAAAAA8s/LdiQLXnihgA/s517/EnCase%2520RAM%25201.png]

After hitting "Next you should see RAM for the requested machine as an option.  "Blue-check" it and hit "Next".

[https://lh6.googleusercontent.com/-5Hkr3eiyM1c/UFD5PfUIVOI/AAAAAAAAA8o/HytwtyjuF7s/s795/EnCase%2520RAM%25202.png]

Then hit "Finish"

[https://lh4.googleusercontent.com/-0tZFfadXXts/UFD5Pne5ioI/AAAAAAAAA80/M-3I4hG2W-M/s800/EnCase%2520RAM%25203.png]

You should see the RAM in your evidence entries window.

[https://lh6.googleusercontent.com/--ReUKbACIGc/UFD5P7nKzdI/AAAAAAAAA88/cPNnTtIjzj8/s563/EnCase%2520RAM%25204%2520View.png]

To acquire the sample, right-click, click on "Acquire"  and follow the acquisition dialog that follows.

[https://lh5.googleusercontent.com/-ZPGJArTY6hE/UFD5PwgBd8I/AAAAAAAAA9I/3UOERvGD4lA/s512/EnCase%2520RAM%25205%2520Acquisition.png]



= Notes = 

You must have libewf installed for the EWF address space to work correctly.  Move the `contrib/plugins/addrspaces/ewf.py` into `volatility/plugins/addrspaces/` (make sure you do not use `ewf-python.py` since it does not appear to work at this time). Then run Volatility against the memory sample as you would a raw sample.

{{{
$ mv contrib/plugins/addrspaces/ewf.py volatility/plugins/addrspaces/
$ python vol.py -f WinXPSP3x86.E01 --profile=WinXPSP3x86 pslist
Volatile Systems Volatility Framework 2.2_alpha
Offset(V)  Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit                
---------- -------------------- ------ ------ ------ -------- ------ ------ -------------------- --------------------
0x8aeda660 System                    4      0     99     2022 ------      0                                          
0x89af3da0 smss.exe                912      4      3       19 ------      0 2011-04-08 17:30:59                      
0x894c3720 csrss.exe              1036    912     14     1086      0      0 2011-04-08 17:31:05                      
0x894ceda0 winlogon.exe           1060    912     22      604      0      0 2011-04-08 17:31:07                      
0x86ff4da0 services.exe           1108   1060     16      417      0      0 2011-04-08 17:31:10                      
0x8705a770 lsass.exe              1120   1060     23      531      0      0 2011-04-08 17:31:10                                            
0x86fdbda0 svchost.exe            1368   1108     16      208      0      0 2011-04-08 17:31:12    
[snip]                 
}}}

= File Format = 

File format details can be found in [http://code.google.com/p/libewf/downloads/detail?name=Expert%20Witness%20Compression%20Format%20%28EWF%29.pdf Joachim Metz's EWF documentation].